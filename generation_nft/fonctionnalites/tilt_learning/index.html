
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation pour le projet Pronochain et ses solutions.">
      
      
        <meta name="author" content="Pronochain">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.4">
    
    
      
        <title>Direction du regard - Pronochain</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.bb3983ee.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="pronochain" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#direction-du-regard" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="En-tête">
    <a href="../../.." title="Pronochain" class="md-header__button md-logo" aria-label="Pronochain" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Pronochain
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Direction du regard
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Effacer" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initialisation de la recherche
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Pronochain" class="md-nav__button md-logo" aria-label="Pronochain" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Pronochain
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Accueil
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Global
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Global" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Global
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_1">
          Configuration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Configuration" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../global/configuration/documentation/" class="md-nav__link">
        Documentation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Génération NFT
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Génération NFT" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Génération NFT
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        Initialisation
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2">
          Configuration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Configuration" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/variables_environnements/" class="md-nav__link">
        Variables d'environnements
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/pre_commit/" class="md-nav__link">
        Pre-commit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/vs_code/" class="md-nav__link">
        Visual Studio Code
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_3">
          Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Python" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/architecture/" class="md-nav__link">
        Architecture
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/packages/" class="md-nav__link">
        Packages
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/tests/" class="md-nav__link">
        Tests
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/regles/" class="md-nav__link">
        Règles et nomenclatures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../python/logging/" class="md-nav__link">
        Logging
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4" type="checkbox" id="__nav_3_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_4">
          Fonctionnalités
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Fonctionnalités" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Fonctionnalités
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../face_detect/" class="md-nav__link">
        Détection d'un visage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../face_landmarks/" class="md-nav__link">
        Masques du visage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../face_aligner/" class="md-nav__link">
        Alignement du visage
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Direction du visage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Direction du visage
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#definition" class="md-nav__link">
    Définition
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contexte" class="md-nav__link">
    Contexte
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ce-quil-faut-savoir-sur-le-machine-learning" class="md-nav__link">
    Ce qu'il faut savoir sur le machine learning
  </a>
  
    <nav class="md-nav" aria-label="Ce qu'il faut savoir sur le machine learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prenons-lexemple-avec-le-modele-de-type-clustering" class="md-nav__link">
    Prenons l'exemple avec le modèle de type clustering :
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-de-machine-learning" class="md-nav__link">
    Type de machine learning
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nos-modeles" class="md-nav__link">
    Nos modèles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#liste-des-packages-a-installer" class="md-nav__link">
    Liste des packages à installer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#premiere-etape-formatage-et-preprocessing-des-donnees" class="md-nav__link">
    Première étape - formatage et preprocessing des données
  </a>
  
    <nav class="md-nav" aria-label="Première étape - formatage et preprocessing des données">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#direction-horizontale" class="md-nav__link">
    Direction horizontale
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#direction-verticale" class="md-nav__link">
    Direction verticale
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rappels-conclusions" class="md-nav__link">
    Rappels / conclusions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deuxieme-etape-tester-un-modele" class="md-nav__link">
    Deuxième étape : tester un modèle
  </a>
  
    <nav class="md-nav" aria-label="Deuxième étape : tester un modèle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    Code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troisieme-etape-generer-son-model" class="md-nav__link">
    Troisième étape : générer son model
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../face_parsing/" class="md-nav__link">
        Récupération des parties du visage
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Application Mobile
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Application Mobile" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Application Mobile
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../application_mobile/" class="md-nav__link">
        Initialisation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../application_mobile/aide/" class="md-nav__link">
        Aides
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../application_mobile/methode/" class="md-nav__link">
        Autres
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../bdd/bdd/" class="md-nav__link">
        Base de donnée
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_1" type="checkbox" id="__nav_6_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_1">
          Configuration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Configuration" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_1">
          <span class="md-nav__icon md-icon"></span>
          Configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/configuration/husky/" class="md-nav__link">
        Husky
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/configuration/php_cs_fixer/" class="md-nav__link">
        PhpCsFixer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/configuration/lint_staged/" class="md-nav__link">
        Lint Staged
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/configuration/commitlint/" class="md-nav__link">
        Commitlint
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/configuration/standard_version/" class="md-nav__link">
        Standard Version
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#definition" class="md-nav__link">
    Définition
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contexte" class="md-nav__link">
    Contexte
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ce-quil-faut-savoir-sur-le-machine-learning" class="md-nav__link">
    Ce qu'il faut savoir sur le machine learning
  </a>
  
    <nav class="md-nav" aria-label="Ce qu'il faut savoir sur le machine learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prenons-lexemple-avec-le-modele-de-type-clustering" class="md-nav__link">
    Prenons l'exemple avec le modèle de type clustering :
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-de-machine-learning" class="md-nav__link">
    Type de machine learning
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nos-modeles" class="md-nav__link">
    Nos modèles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#liste-des-packages-a-installer" class="md-nav__link">
    Liste des packages à installer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#premiere-etape-formatage-et-preprocessing-des-donnees" class="md-nav__link">
    Première étape - formatage et preprocessing des données
  </a>
  
    <nav class="md-nav" aria-label="Première étape - formatage et preprocessing des données">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#direction-horizontale" class="md-nav__link">
    Direction horizontale
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#direction-verticale" class="md-nav__link">
    Direction verticale
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rappels-conclusions" class="md-nav__link">
    Rappels / conclusions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deuxieme-etape-tester-un-modele" class="md-nav__link">
    Deuxième étape : tester un modèle
  </a>
  
    <nav class="md-nav" aria-label="Deuxième étape : tester un modèle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    Code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troisieme-etape-generer-son-model" class="md-nav__link">
    Troisième étape : générer son model
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="direction-du-regard">Direction du regard</h1>
<h2 id="definition">Définition</h2>
<p>Le <strong>tilt learning</strong> est un <strong>algorithme de machine learning</strong>. Il a été créé pour savoir si le <strong>visage détecté</strong> est orienté de la bonne façon. Un visage correctement orienté est un visage qui <strong>regarde droit devant</strong>.</p>
<hr />
<div style="display:flex;flex-direction:row;justify-content:space-around;margin-top:8px;margin-bottom:10px;">
    <div style="display:flex;flex-direction:column;">
        <div style="display:flex;flex-direction:row;align-items:center; justify-content:center;margin-bottom:4px;">
            <img src="../../../pictures/generation_nft/tilt_learning/error.png" style="width:24px;height:24px;margin-right: 2px;">
            <h3 style="margin:0 0 0 6px !important;">Mauvais MBAPPE</h3>
        </div>
        <img src="../../../pictures/generation_nft/tilt_learning/kilian-wrong.jpg" style="width:300px;height:200px;">
    </div>
    <div style="display:flex; flex-direction: column;">
        <div style="display:flex;flex-direction:row;align-items:center; justify-content:center;margin-bottom:4px;">
            <img src="../../../pictures/generation_nft/tilt_learning/check.png" style="width:24px;height:24px;margin-right:2px;">
            <h3 style="margin:0 0 0 6px !important;">Bon MBAPPE</h3>
        </div>
        <img src="../../../pictures/generation_nft/tilt_learning/kilian-good.jpg" style="width:160px;height:200px;">
    </div>
</div>

<hr />
<h2 id="contexte">Contexte</h2>
<p>Le but est de pouvoir générer une <strong>image originale tirée d'un visage d'un joueur de foot</strong>. La problématique était de détecter un visage. Grâce à plusieurs packages externes : <strong>OpenCV et MediaPipe</strong>, il a été très facile de <strong>récupérer plusieurs points</strong> importants du <strong>visage</strong> afin de <strong>tracer les contours</strong>. Cependant, la question de la <strong>direction du regard</strong> s'est vite posée. Il n'y a aucun <strong>package externe</strong> pour réaliser cette vérification de <strong>façon optimale</strong>. Il existe des solutions similaires, mais <strong>uniquement</strong> pour des <strong>vidéos</strong>. L'une des solutions les <strong>moins coûteuses en termes de temps</strong> que ce soit au niveau du <strong>temps de veille</strong>, du <strong>temps de monté en compétence</strong> et du <strong>temps de mise en place</strong> est le <strong>machine learning</strong>. Il existe d'autres notions efficaces : le <strong>deep learning</strong> et les <strong>réseaux neuronaux</strong>. Ces deux notions sont cependant bien <strong>plus complexes</strong> et ont une <strong>précision similaire</strong> comparée à un bon machine learning bien entrainé.</p>
<h2 id="ce-quil-faut-savoir-sur-le-machine-learning">Ce qu'il faut savoir sur le machine learning</h2>
<p>Par définition, le machine learning est une <strong>technologie d’intelligence artificielle</strong> permettant aux ordinateurs d’apprendre <strong>sans avoir été programmés</strong> explicitement à cet effet. Pour apprendre et se développer, les ordinateurs ont toutefois <strong>besoin de données à analyser</strong> et sur lesquelles s’entraîner. La plupart du temps, le machine learning est pour réaliser une <strong>prédiction</strong>. En réalité, ces technologies d'intelligence artificielle sont des <strong>algorithmes</strong> (modèles) qui <strong>interprètent plusieurs données</strong> et les regroupent sous forme <strong>logique</strong>. Il est possible de représenter ce que fait le modèle de machine learning sous forme d'un <strong>graphique</strong>.</p>
<h3 id="prenons-lexemple-avec-le-modele-de-type-clustering">Prenons l'exemple avec le modèle de type clustering :</h3>
<p><img src="../../../pictures/generation_nft/tilt_learning/cluster.png"></p>
<p>On peut voir <strong>plusieurs types d'algorithmes clustering</strong> (colonne). Ce sont des algorithmes qui vont regrouper de manière <strong>logique</strong> différentes données afin d'en faire une <strong>catégorie</strong>. Ces données sont considérées comme des <strong>données d'entrainement</strong>. Chacune de ces données peut être identifiée afin de fournir une base à l'algorithme. Dans notre exemple, il n'est pas obligatoire de lui fournir une catégorisation. Le <strong>clustering</strong> peut regroupé de manière <strong>mathématique</strong> les données. Lorsque l'on testera une nouvelle donnée pour faire une prédiction, <strong>l'algorithme analysera les données de la même manière que les données qui ont servi pour tester le modèle</strong>. Il pourra par la suite dire que cette donnée correspond aux données de la <strong>catégorie x.</strong></p>
<h2 id="type-de-machine-learning">Type de machine learning</h2>
<p>Il existe beaucoup de <strong>types de machine learning</strong> qui eu même ont <strong>plusieurs sous types</strong>. Dans notre solution, nous utilisons le <strong>package scikit-learn</strong> qui permet de facilité l'utilisation de ces modèles. Scikit-learn fourni une <strong>très bonne documentation</strong> pour connaître tous les paramètres de chaque modèle et leur fonctionnement.
Chaque modèle est <strong>optimisé</strong> pour des <strong>types de données</strong>, <strong>quantité de données</strong> et l'objectif de la prédiction. Voici un <strong>schéma</strong> pour savoir quel modèle sera le plus adapté à ce que l'on souhaite faire :</p>
<p><img src="../../../pictures/generation_nft/tilt_learning/models.png"></p>
<h2 id="nos-modeles">Nos modèles</h2>
<p>Dans notre solution, si on suit le schéma au-dessus, nous avons plus de <strong>50 données</strong> de test (différentes images de plusieurs visages regardant dans des directions différentes).<br><br>
Nous souhaitons prédire <strong>une catégorie</strong>. Nos catégories ici seront les différentes directions : <strong>haut, bas, gauche, droit, en face</strong>. Le fait de vouloir prédire une catégorie signifie que les modèles de type <strong>regression et dimensionality reduction</strong> ne seront pas très utiles.<br><br>
Par la suite, le schéma nous demande s'il y a la <strong>présence de texte</strong> : <strong>oui (haut, bas ...)</strong>. Les modèles <strong>clustering</strong> ne sont donc pas conseillés.<br><br>
Ensuite, nous rentrons enfin dans un type de machine learning : <strong>classification</strong>. La première information importante est de connaître le <strong>nombre de données de test</strong>. Malheureusement, réunir plus de <strong>100 000 données</strong> quand il s'agit d'image est une mission quasiment impossible, sachant qu'il faut toutes les identifier en termes de direction.</p>
<pre><code>???+ info "Augmentation d'image"
    Cependant, il est possible de faire de **l'augmentation d'image**, c'est-à-dire **multiplier** le nombre d'images avec **celle que l'on a déjà**. Par exemple, retourner l'image horizontalement. Ce qui multipliera par deux le nombre d'images.
    &lt;div style="display:flex;flex-direction:row;justify-content:center;margin-bottom:10px;"&gt;
        &lt;img src="../../../pictures/generation_nft/tilt_learning/kilian-left.jpg" style="width:321px;height:191px;margin-right:10px;"&gt;
        &lt;img src="../../../pictures/generation_nft/tilt_learning/kilian-right.jpg" style="width:321px;height:191px;margin-left:10px;"&gt;
    &lt;/div&gt;
</code></pre>
<p>Nous croisons un <strong>premier modèle</strong> : <strong>LinearSVC</strong>. Nous pourrions nous arrêter ici et tester ce modèle avec nos données. Mais pour que notre <strong>prédiction</strong> soit <strong>la plus précise</strong> possible, nous pouvons sélectionner <strong>plusieurs modèles</strong>. Nous allons donc sélectionner les modèles suivant: <strong>Naive Bayes, KNeighbors classifier, SVC et Ensemble classifiers</strong>. À savoir qu'il existe <strong>plusieurs types de modèle</strong> pour le Naive Bayes, pour le KNeighbors classifier et pour les Ensemble classifiers.<br><br>
Le plus efficace pour prédire correctement est d'avoir un <strong>nombre impair</strong> de modèles pour récupérer à chaque fois la <strong>prédiction la plus présente</strong>. Si jamais le nombre est pair est qu'une égalité survient, il sera difficile d'identifié la prédiction a privilégier.</p>
<h2 id="liste-des-packages-a-installer">Liste des packages à installer</h2>
<ul>
<li><strong><a href="https://numpy.org/">numpy</a></strong></li>
<li><strong><a href="https://github.com/PyImageSearch/imutils">imutils</a></strong></li>
<li><strong><a href="http://dlib.net/">dlib</a></strong></li>
<li><strong><a href="https://google.github.io/mediapipe/getting_started/python.html">mediapipe</a></strong></li>
<li><strong><a href="https://pandas.pydata.org/">pandas</a></strong></li>
<li><strong><a href="https://scikit-learn.org/stable/">scikit-learn</a></strong></li>
<li><strong><a href="https://opencv.org/">opencv-python</a></strong></li>
<li><strong><a href="https://scikit-image.org/">scikit-image</a></strong></li>
<li><strong><a href="https://joblib.readthedocs.io/en/latest/">joblib</a></strong></li>
</ul>
<h2 id="premiere-etape-formatage-et-preprocessing-des-donnees"><strong>Première étape</strong> - formatage et preprocessing des données</h2>
<p>Pour pouvoir réaliser un machine learning efficace, outre le nombre d'image, il faut des données <strong>cohérentes</strong> et <strong>nettoyer</strong>. A ce stade, nous avons déjà récupéré les landmarks (zone du visage). <a href="../face_landmarks/">Voir la documentation</a> sur la détection de la zone du visage pour comprendre quelles sont les données récupérées. Nous avons donc <strong>486 points</strong> du visage avec un <strong>x</strong> correspondant à la position en <strong>largeur</strong>, un <strong>y</strong> correspondant à la position en <strong>hauteur</strong> et enfin un <strong>z</strong> correspondant à la profondeur.</p>
<div style="display:flex;justify-content:center;margin-bottom:10px;height:300px;">
    <img src="../../../pictures/generation_nft/tilt_learning/landmark.png">
</div>

<p>Dans la documentation, j'explique que le <strong>z</strong> est calculé par rapport à une <strong>feuille à plat</strong>. Tout ce qui est <strong>avant</strong> (plus près de la caméra) sera <strong>positif</strong>, tout ce qui est <strong>après</strong> (plus loin dans la photo) sera <strong>négatif</strong>. Cependant, ces valeurs sont toutes <strong>différentes selon la photo, selon le visage et surtout selon l'échelle qui n'est jamais la même</strong>. Cette notion d'échelle est très importante pour le machine learning. Il sera beaucoup moins efficace si ces données ne sont pas sur la même plage de données.</p>
<p>À ce stade nous avons donc <strong>486 points * 3</strong> (x, y et z). Si nous donnons les coordonnées de tous ces points en données, il y a de fortes chances qu'ils ne <strong>trouvent jamais si la photo est correcte</strong>. Les <strong>visages sont tous différents</strong>, des personnes ont des mentons moins profonds que le front, d'autres ont un nez plus imposant, ... Il faut donc récupérer <strong>uniquement les informations qui nous permettront d'avoir des informations performantes et pertinentes</strong>.</p>
<h3 id="direction-horizontale">Direction horizontale</h3>
<p>Il existe <strong>plusieurs façons</strong>, avec les points que l'on a, pour déterminer si le visage regarde à <strong>gauche</strong> ou à <strong>droite</strong>. Pour que le machine learning soit <strong>efficace</strong>, nous allons récupérer <strong>deux données</strong> qui à elle seule pourraient déterminer si le visage regarde dans une direction. Cependant, si l'on augmente le nombre de données, le machine learning sera bien plus <strong>précis</strong>. Avant de commencer, toutes ses données partent du principe que chaque visage a une <strong>différence de symétrie négligeable</strong>. Nous avons tous plus ou moins un visage symétrique. Et la cible que nous souhaitons "cartoonisé" sont en général <strong>très sportif</strong> et <strong>sans handicap majeur</strong>.</p>
<details class="danger not-expand" open="open">
<summary>Ribéry est notre ennemi</summary>
</details>
<p><br></p>
<p><strong><a stlye="font-size: 20px;">Première méthode</a></strong></p>
<p>La <strong>profondeur de deux points</strong> peut déterminer une direction. Dans notre cas, nous prenons le <strong>point du visage le plus à gauche</strong> et le <strong>point du visage le plus à droite</strong>. Et nous regardons la <strong>différence</strong> en pourcentage entre les deux profondeurs. Si la différence dépasse un certain seuil, <strong>seuil qui sera géré par le machine learning</strong>, le visage regardera à droite ou à gauche. Pour mieux comprendre, nous allons, prendre <strong>l'axe Z</strong> que nous allons utilisé <strong>comme X</strong> et l'axe des <strong>Y</strong>.</p>
<div style="display:flex;justify-content:space-around;margin-bottom:10px;height:300px;">
    <img src="../../../pictures/generation_nft/tilt_learning/horizontale-1.png">
    <img src="../../../pictures/generation_nft/tilt_learning/horizontale-1-expli.png">
</div>

<p>Sur l'exemple, si on regarde le schéma, on voit que le point de gauche à sa profondeur Z (<strong>x dans le schéma</strong>) <strong>plus proche de 0</strong>, le <strong>0</strong> correspond ici à l'<strong>objectif de la caméra</strong> (ou l'écran), que le <strong>point de droite légèrement plus éloigné de 0, plus profond</strong>. Si vous mettez vos <strong>doigts de chaque côté de votre visage</strong> et que votre <strong>écran d'ordinateur</strong> correspond au <strong>0</strong>, vous verrez que si vous tournez la <strong>tête à gauche</strong>, votre <strong>doigt à droite</strong> de votre visage se <strong>rapproche de l'écran</strong> tandis que le point gauche s'en éloigne. Ces données pourront donc être ajoutées à notre <strong>datasets</strong> (jeu de données qui seront analysées par le machine learning).
<br><br></p>
<p><strong><a stlye="font-size: 20px;">Deuxième méthode</a></strong></p>
<p>Cette méthode se base essentiellement sur la <strong>symétrie du visage</strong>. En toute logique, un visage qui regarde la caméra droit devant, aura des <strong>proportions identiques</strong> entre la partie <strong>gauche du visage</strong> et la partie <strong>droite du visage</strong>. Il suffit, pour vérifier, de prendre une distance entre deux points sur la partie gauche, et prendre leur <strong>deux points symétriques du côté droit</strong> du visage et calculer la <strong>différence</strong> entre les deux distances de chaque point.</p>
<div style="display:flex;justify-content:center;margin-bottom:10px;height:300px;">
    <img src="../../../pictures/generation_nft/tilt_learning/horizontale-2.png">
</div>

<p>On remarque assez facilement que la <strong>distance à gauche est plus grande</strong> que la distance à droite. Ce phénomène s'explique par le fait que la <strong>partie d'un visage</strong> est <strong>compressée</strong> par rapport à <strong>l'observateur</strong>.</p>
<p>Nous avons deux valeurs plutôt précises qui assemblées, augmenterons la performance du machine learning à <strong>détecter</strong> si le visage <strong>regarde trop à droite ou trop à gauche</strong>.</p>
<h3 id="direction-verticale">Direction verticale</h3>
<p>Cette <strong>partie a été la plus compliquée</strong> à réaliser, mais elle s'avère la plus efficace. Pour identifier la direction <strong>vers le haut ou vers le bas</strong>, il y a plusieurs facteurs qui compliquent la lecture des données. Les <strong>visages</strong> sont tous <strong>différents</strong> en ce qui concerne la profondeur de leur visage.</p>
<p>Logiquement, on <strong>pourrait se dire</strong> : c'est plutôt simple, on prend la <strong>profondeur du point le plus haut</strong> et <strong>du plus bas du visage</strong> et on regarde la différence. Voilà pourquoi il n'est pas possible de faire cela :</p>
<div style="display:flex;justify-content:space-around;margin-bottom:10px;height:300px;">
    <img src="../../../pictures/generation_nft/tilt_learning/profil-1.jpg">
    <img src="../../../pictures/generation_nft/tilt_learning/profil-2.jpg">
</div>

<p>Ici, comme pour la <strong>première méthode horizontale</strong>, on met la <strong>profondeur sur X</strong> en gardant Y. Cela nous permet d'avoir le <strong>profil de la photo</strong>.
On voit clairement que pour la première, il n'y aurait pas de problème, cependant la seconde, on remarque que son menton est <strong>toujours plus avancé que son front</strong>. Si on devait ajouter ces données dans un machine learning, je suis sûr que la prédiction serait souvent <strong>fausse</strong> car ses données ressembleraient trop aux données d'une personne qui regarde <strong>légèrement vers le haut</strong>. Cela fonctionne aussi dans le sens inverse (le bas), même si c'est plus rare.</p>
<p>La première méthode consiste à <strong>rajouter deux points de références</strong> au niveau du <strong>nez</strong> et du côté de <strong>l'oreille</strong>. Ces points de références nous permettront de réaliser <strong>plusieurs calculs</strong> pour en retirer des <strong>informations</strong>. Bien sûr la méthode sera multipliée par deux, côté <strong>gauche</strong> et côté <strong>droit</strong>.</p>
<div style="display:flex;justify-content:center;margin-bottom:20px;height:300px;">
    <img src="../../../pictures/generation_nft/tilt_learning/profil-3.jpg">
    <img src="../../../pictures/generation_nft/tilt_learning/profil-4.jpg">
</div>
<div style="display:flex;justify-content:center;margin-bottom:20px;height:300px;">
    <img src="../../../pictures/generation_nft/tilt_learning/profil-5.jpg">
</div>

<p><br><br></p>
<p><strong><a stlye="font-size: 20px;">Première méthode</a></strong></p>
<p>Ce sont les lignes <strong>grises et roses</strong> (zoomer pour les voir) qui vont nous intéresser dans un premier temps. Nous allons reprendre la différence entre les <strong>deux lignes grises</strong> en bas et en haut qui correspondent à la distance entre le <strong>front et le nez et le menton et le nez</strong>. Puis reprendre la <strong>hauteur entre le nez et le point à côté de l'oreille</strong> (les lignes roses). Avec ces deux données, le machine learning pourra déjà prédire correctement <strong>plus de la moitié des cas</strong>.</p>
<p>Il faut savoir que cette méthode réduit légèrement le <strong>facteur de la morphologie du visage</strong>, mais elle ne pourra pas fonctionner seule, il faut obligatoirement <strong>la deuxième méthode</strong> pour que le machine learning puisse <strong>identifier un pattern</strong> dans ces données.
<br><br></p>
<p><strong><a stlye="font-size: 20px;">Deuxième méthode</a></strong></p>
<p>Pour que la première méthode fonctionne, il faut une <strong>valeur verticale de référence</strong>. Il y a beaucoup d'études plus ou moins scientifique qui ont été faites sur la morphologie et sur les <strong>différentes règles de mensuration</strong> d'un visage. Celle qui nous intéresse ici est la mensuration entre <strong>le menton et le nez</strong> et <strong>le nez et le haut front</strong>. Pour mieux comprendre, voici une image :</p>
<div style="display:flex;justify-content:center;margin-bottom:20px;height:250px;">
    <img src="../../../pictures/generation_nft/tilt_learning/morphologie-visage.png">
</div>

<p>La plupart du temps, cette proportion est respectée, il y a bien entendu un <strong>pourcentage de précision</strong> pour ne pas exclure les <strong>cas extrêmes</strong>, mais encore une fois, c'est au rôle du machine learning d'effectuer ces vérifications.</p>
<p>Dans notre datasets, il n'y aura plus cas rajouter les informations de la <strong>première méthode</strong> et les <strong>distances de la deuxième méthode</strong>.</p>
<p>Pour les deux méthodes, comme nous le faisons à droite et à gauche, nous reprenons à chaque fois la <strong>moyenne entre toutes les valeurs</strong>.</p>
<h3 id="rappels-conclusions">Rappels / conclusions</h3>
<p>Il y a <strong>5 données</strong>, <strong>2 horizontales</strong> et <strong>3 verticales</strong>. Elles correspondent à notre datasets. C'est ces données que l'on donnera au modèle du machine learning. En plus, il nous faudra une dernière donnée, l'une des plus importantes pour entraîné notre machine learning : la <strong>direction du visage</strong>. Comme on sait où se situe nos images de test et à quoi elles correspondent, on aura plus qu'à rajouter : <strong>"up", "down", "left", "right", "front"</strong>.</p>
<h2 id="deuxieme-etape-tester-un-modele">Deuxième étape : tester un modèle</h2>
<p>Comme dit précédemment, le package <strong>scikit-learn</strong> fourni les modèles, il suffit simplement d'importer les modèles souhaités. Sur ce <strong><a href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.neural_network">site</a></strong>, vous trouvez tous les types de modèles. Ceux qui nous intéressent finissent la plupart du temps par le mot <strong>Classifier</strong>.</p>
<p>Pour cette documentation, on testera le modèle <strong>RandomForestClassifier</strong>. Avant tout, il est important de comprendre comment il fonctionne. <strong>Random forest</strong> signifie <strong>forêt aléatoire</strong>, il est basé sur les <strong>arbres de décisions</strong>.</p>
<div style="display:flex;justify-content:center;margin-bottom:10px;">
    <img src="../../../pictures/generation_nft/tilt_learning/arbrededecision.png">
</div>

<p>L'arbre de décision, <strong>à chaque valeur d'une première donnée</strong>, la divise en <strong>plusieurs possibilités</strong>. Il va choisir ensuite celle qui <strong>correspond la mieux</strong>, puis va proposer <strong>toutes les possibilités d'une deuxième donnée</strong>, etc.
Le principe de la random forest est de <strong>multiplier aléatoirement</strong> les arbres de décisions. Chaque arbre <strong>appréhendera les données de façon différentes</strong>. À la fin, la donnée à prédire aura <strong>traversée chaque arbre</strong>, les résultats seront <strong>assemblés</strong> afin de proposer une <strong>prédiction finale</strong>.</p>
<h3 id="code">Code</h3>
<p>Pour pouvoir commencer à <strong>créer</strong> notre modèle et <strong>l'entraîner</strong>, il faut des données. Dans notre solution, les données qui ont servi à entraîner le modèle se trouvaient dans les dossiers <em>app/generation_nft/librairies/tilt_learning/tests/...</em>. Dans le dossier se trouvait <strong>5 dossiers</strong> correspondant aux différentes directions des visages. Grâce à la <strong>première étape</strong>, nous avons un fichier <strong>JSON</strong> comportant toutes les informations nécessaires. Il n'y a plus qu'a importé les données dans une variable appelée <strong>datasets</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">read_json</span>

<span class="n">data_frame</span> <span class="o">=</span> <span class="n">read_json</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tilt_datasets_path</span><span class="p">)</span>
</code></pre></div>
<p>data_frame est du type <strong>DataFrame</strong> de la libraire pandas. Cette classe est analysable par tous les modèles de machine learning fourni par <strong>scikit-learn</strong>.</p>
<p>Ensuite, il faut <strong>diviser ces données en deux</strong>, les données de <strong>d'entraînement</strong> et les données de <strong>test</strong>. Les données d'entraînement serviront à, comme son nom l'indique, <strong>entraîner le modèle</strong>. On fournira au modèle ces données avec la <strong>direction du visage</strong> pour chaque donnée. Pour les données de test, on essayera de les prédire et de faire correspondre la direction prédite avec la réelle direction, c'est ce qui nous donnera un <strong>pourcentage de précision du modèle</strong>.
Pour effectuer cette séparation, il faut utiliser la fonction <strong>train_test_split</strong>. Elle accepte un paramètre <strong>test_size</strong> qui correspond à un <strong>pourcentage de division</strong>. 0.2 signifie que <strong>20%</strong> des données seront des données de test et <strong>80%</strong> seront celles qui entraîneront le modèle.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">trainset</span><span class="p">,</span> <span class="n">testset</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>
<p>Pour pouvoir insérer les données correctement dans le modèle, il faut les <strong>"preprocess"</strong>, les traiter. C'est-à-dire <strong>encoder</strong> puis <strong>isoler</strong> la donnée cible de prédiction. De notre côté, c'est la direction du visage, la <strong>dernière colonne dans le DataFrame</strong>.
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;horizontal_distance_difference&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">96</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;horizontal_z_difference&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">92</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;vertical_distance_difference&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">91</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;percentage_distance_middlepoint_difference&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">64</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;front&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div></p>
<p>Pour l'encodage, nous allons convertir les <strong>valeurs textes en chiffres</strong> :
<div class="highlight"><pre><span></span><code><span class="n">code</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;up&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;front&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">data_frame</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="s2">&quot;object&quot;</span><span class="p">):</span>
    <span class="n">data_frame</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_frame</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</code></pre></div></p>
<p>Toutes les directions sauf "front" auront la valeur 1. Pour faire la modification, on <strong>parcourt les colonnes textes</strong> (<strong>object</strong>) du DataFrame et on effectue un <strong>mapping des valeurs</strong>.</p>
<p>Pour l'isolation de la donnée cible, il nous suffit de <strong>slice</strong> le DataFrame, comme s'il s'agissait d'une liste ou un tableau.
<div class="highlight"><pre><span></span><code><span class="n">target_column</span> <span class="o">=</span> <span class="s2">&quot;class&quot;</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">data_frame</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">target_column</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data_frame</span><span class="p">[</span><span class="n">target_column</span><span class="p">]</span>
</code></pre></div></p>
<p>Passons à l'étape tant attendue, <strong>l'ajout des données</strong> dans le modèle.
Il faut tout d'abord, <strong>importer le modèle</strong>. Nous allons aussi importer en plus différentes fonctions qui permettrons de <strong>mettre une valeur sur la précision de la prédiction</strong>. Ensuite, il ne nous reste plus qu'à entraîner notre modèle, puis de prédire les données de test.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span> <span class="c1"># FONCTION QUI ENCODE ET ISOLE</span>
<span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing</span><span class="p">(</span><span class="n">testset</span><span class="p">)</span> <span class="c1"># FONCTION QUI ENCODE ET ISOLE</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</code></pre></div>
<p>Et voilà, le modèle du machine learning a été <strong>créé et entraîné</strong>. Bien entendu, il y a plusieurs <strong>paramètrages</strong> pour <strong>améliorer la précision</strong> pour chaque modèle. Pour savoir quels sont les paramètres les plus optimaux afin d'améliorer la précision, il faut utiliser <strong>GridSearchCV</strong>. Il n'y aura pas plus d'information concernant cette méthode dans cette documentation, mais je vous conseille d'allé regarder cette <strong><a href="https://www.youtube.com/watch?v=r58meM7ieaQ">vidéo</a></strong>.</p>
<h2 id="troisieme-etape-generer-son-model">Troisième étape : générer son model</h2>
<p>Dernier point de cette documentation, <strong>l'exportation du modèle</strong>. En production, nous n'allons pas réentrainer le modèle et retester la prédiction. Nous souhaitons uniquement lui <strong>fournir une donnée</strong> et que <strong>le modèle la prédise</strong>.</p>
<p>Pour exporter le modèle, le package <strong>joblib</strong> nous permet de le faire très simplement.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">dump</span> <span class="k">as</span> <span class="n">dump_model</span>

<span class="n">dump_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_path</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_model.pkl&quot;</span><span class="p">)</span> <span class="c1"># URL OUTPUT</span>
</code></pre></div>
<p>Dans le code, il suffira de <strong>charger le modèle</strong> avec la même librairie.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">load</span> <span class="k">as</span> <span class="n">load_model</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction</span> <span class="kn">import</span> <span class="n">DictVectorizer</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_path</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">dict_model</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_model.pkl&quot;</span><span class="p">)</span>
<span class="n">datasets_array</span> <span class="o">=</span> <span class="n">DictVectorizer</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span> <span class="c1"># CONVERTI LES DONNEES EN DATAFRAME</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">datasets_array</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># CORRESPOND à 1 (pas front) ou 2 (front)</span>
</code></pre></div>
<details class="question not-expand">
<summary>Si vous avez des questions, n'hésitez pas à les poser sur les supports adaptés.</summary>
</details>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Retour en haut de la page
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Pied de page">
      
        
        <a href="../face_aligner/" class="md-footer__link md-footer__link--prev" aria-label="Précédent: Alignement du visage" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Précédent
              </span>
              Alignement du visage
            </div>
          </div>
        </a>
      
      
        
        <a href="../face_parsing/" class="md-footer__link md-footer__link--next" aria-label="Suivant: Récupération des parties du visage" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Suivant
              </span>
              Récupération des parties du visage
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 - 2022 Pronochain
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://mobile.twitter.com/pronochain" target="_blank" rel="noopener" title="mobile.twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tracking", "navigation.top"], "translations": {"clipboard.copy": "Copier dans le presse-papier", "clipboard.copied": "Copi\u00e9 dans le presse-papier", "search.config.lang": "fr", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Rechercher", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.term.missing": "Non trouv\u00e9", "select.version.title": "S\u00e9lectionner la version"}, "search": "../../../assets/javascripts/workers/search.361d90f1.min.js"}</script>
    
    
      <script src="../../../assets/javascripts/bundle.289a2a4b.min.js"></script>
      
    
  </body>
</html>